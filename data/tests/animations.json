{
  "group": "animations",
  "constructor": [
    {
      "step_type": "function",
      "function_name": "set_resources_path",
      "args": [
        {
          "value_type": "string",
          "value": "set this value before running tests, use an absolute path"
        }
      ]
    }
  ],
  "cleanup": [
    {
      "cleanup_type": "animation_script",
      "function_name": "free_all_animation_scripts",
      "args": []
    },
    {
      "cleanup_type": "animation",
      "function_name": "free_animation",
      "args": [
        {
          "value_type": "object",
          "object_type": "animation",
          "variable_name": "animation"
        }
      ]
    }
  ],
  "tests": [
    {
      "name": "animation_count",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "kermit"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ],
          "store_result": "test_script"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "function",
          "function_name": "animation_count",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_script"
            }
          ],
          "store_result": "count"
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "greater_than",
            "value1": {
              "value_type": "variable",
              "variable_name": "count"
            },
            "value2": {
              "value_type": "int",
              "value": 0
            }
          }
        }
      ]
    },
    {
      "name": "animation_current_cell",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "kermit"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ],
          "store_result": "test_script"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "function",
          "function_name": "create_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_script"
            },
            {
              "value_type": "string",
              "value": "moonwalkback"
            }
          ],
          "store_result": "test_animation"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation",
          "store_result": "cleanup_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ]
        },
        {
          "step_type": "function",
          "function_name": "animation_current_cell",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ],
          "store_result": "current_cell"
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "greater_than",
            "value1": {
              "value_type": "variable",
              "variable_name": "current_cell"
            },
            "value2": {
              "value_type": "int",
              "value": -1
            }
          }
        }
      ]
    },
    {
      "name": "animation_current_vector",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "kermit"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ],
          "store_result": "test_script"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "function",
          "function_name": "create_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_script"
            },
            {
              "value_type": "string",
              "value": "moonwalkback"
            }
          ],
          "store_result": "test_animation"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation",
          "store_result": "cleanup_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ]
        },
        {
          "step_type": "function",
          "function_name": "animation_current_vector",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ],
          "store_result": "current_vector"
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "equal",
            "value1": {
              "value_type": "double",
              "value": 0.0
            },
            "value2": {
              "value_type": "variable_field",
              "variable_name": "current_vector",
              "variable_field": "x"
            }
          }
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "equal",
            "value1": {
              "value_type": "double",
              "value": 0.0
            },
            "value2": {
              "value_type": "variable_field",
              "variable_name": "current_vector",
              "variable_field": "y"
            }
          }
        }
      ]
    },
    {
      "name": "animation_ended",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "kermit"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ],
          "store_result": "test_script"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "function",
          "function_name": "create_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_script"
            },
            {
              "value_type": "string",
              "value": "moonwalkback"
            }
          ],
          "store_result": "test_animation"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation",
          "store_result": "cleanup_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ]
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "false",
            "value1": {
              "value_type": "function",
              "function_name": "animation_ended",
              "args": [
                {
                  "value_type": "variable",
                  "variable_name": "test_animation"
                }
              ]
            }
          }
        },
        {
          "step_type": "loop",
          "iterations": 50,
          "loop_steps": [
            {
              "step_type": "function",
              "function_name": "update_animation_percent",
              "args": [
                {
                  "value_type": "variable",
                  "variable_name": "test_animation"
                },
                {
                  "value_type": "float",
                  "value": 100.0
                }
              ]
            }
          ]
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "true",
            "value1": {
              "value_type": "function",
              "function_name": "animation_ended",
              "args": [
                {
                  "value_type": "variable",
                  "variable_name": "test_animation"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "animation_entered_frame",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "kermit"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ],
          "store_result": "test_script"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "function",
          "function_name": "create_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_script"
            },
            {
              "value_type": "string",
              "value": "walkfront"
            }
          ],
          "store_result": "test_animation"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation",
          "store_result": "cleanup_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ]
        },
        {
          "step_type": "function",
          "function_name": "update_animation_percent",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            },
            {
              "value_type": "float",
              "value": 20
            }
          ]
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "true",
            "value1": {
              "value_type": "function",
              "function_name": "animation_entered_frame",
              "args": [
                {
                  "value_type": "variable",
                  "variable_name": "test_animation"
                }
              ]
            }
          }
        },
        {
          "step_type": "function",
          "function_name": "update_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ]
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "false",
            "value1": {
              "value_type": "function",
              "function_name": "animation_entered_frame",
              "args": [
                {
                  "value_type": "variable",
                  "variable_name": "test_animation"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "animation_frame_time",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "kermit"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ],
          "store_result": "test_script"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "function",
          "function_name": "create_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_script"
            },
            {
              "value_type": "string",
              "value": "walkfront"
            }
          ],
          "store_result": "test_animation"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation",
          "store_result": "cleanup_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ]
        },
        {
          "step_type": "function",
          "function_name": "update_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ]
        },
        {
          "step_type": "function",
          "function_name": "animation_frame_time",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ],
          "store_result": "frame_time"
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "greater_than",
            "value1": {
              "value_type": "variable",
              "variable_name": "frame_time"
            },
            "value2": {
              "value_type": "float",
              "value": 0.0
            }
          }
        }
      ]
    },
    {
      "name": "animation_index",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "kermit"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ],
          "store_result": "test_script"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "function",
          "function_name": "animation_index",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_script"
            },
            {
              "value_type": "string",
              "value": "walkfront"
            }
          ],
          "store_result": "index"
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "greater_than",
            "value1": {
              "value_type": "variable",
              "variable_name": "index"
            },
            "value2": {
              "value_type": "int",
              "value": -1
            }
          }
        },
        {
          "step_type": "function",
          "function_name": "animation_index",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_script"
            },
            {
              "value_type": "string",
              "value": "NonExistentAnimation"
            }
          ],
          "store_result": "non_existent_index"
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "equal",
            "value1": {
              "value_type": "int",
              "value": -1
            },
            "value2": {
              "value_type": "variable",
              "variable_name": "non_existent_index"
            }
          }
        }
      ]
    },
    {
      "name": "animation_name",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "kermit"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ],
          "store_result": "test_script"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "function",
          "function_name": "create_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_script"
            },
            {
              "value_type": "string",
              "value": "moonwalkback"
            }
          ],
          "store_result": "test_animation"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation",
          "store_result": "cleanup_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ]
        },
        {
          "step_type": "function",
          "function_name": "animation_name",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ],
          "store_result": "anim_name"
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "equal",
            "value1": {
              "value_type": "string",
              "value": "moonwalkback"
            },
            "value2": {
              "value_type": "variable",
              "variable_name": "anim_name"
            }
          }
        }
      ]
    },
    {
      "name": "animation_script_name",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "kermit"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ],
          "store_result": "test_script"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "function",
          "function_name": "animation_script_name",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_script"
            }
          ],
          "store_result": "script_name"
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "equal",
            "value1": {
              "value_type": "string",
              "value": "kermit"
            },
            "value2": {
              "value_type": "variable",
              "variable_name": "script_name"
            }
          }
        }
      ]
    },
    {
      "name": "animation_script_named",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "kermit"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ],
          "store_result": "test_script"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "function",
          "function_name": "animation_script_named",
          "args": [
            {
              "value_type": "string",
              "value": "kermit"
            }
          ]
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "not_null",
            "value1": {
              "value_type": "variable",
              "variable_name": "test_script"
            }
          }
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "equal",
            "value1": {
              "value_type": "variable",
              "variable_name": "test_script"
            },
            "value2": {
              "value_type": "variable",
              "variable_name": "test_script"
            }
          }
        }
      ]
    },
    {
      "name": "assign_animation_with_script",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "kermit"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ],
          "store_result": "test_script"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "function",
          "function_name": "create_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_script"
            },
            {
              "value_type": "string",
              "value": "moonwalkback"
            }
          ],
          "store_result": "test_animation"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation",
          "store_result": "cleanup_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ]
        },
        {
          "step_type": "function",
          "function_name": "assign_animation_with_script",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            },
            {
              "value_type": "variable",
              "variable_name": "test_script"
            },
            {
              "value_type": "string",
              "value": "walkfront"
            }
          ]
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "equal",
            "value1": {
              "value_type": "string",
              "value": "walkfront"
            },
            "value2": {
              "value_type": "function",
              "function_name": "animation_name",
              "args": [
                {
                  "value_type": "variable",
                  "variable_name": "test_animation"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "assign_animation_with_script_and_sound",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "kermit"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ],
          "store_result": "test_script"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "function",
          "function_name": "create_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_script"
            },
            {
              "value_type": "string",
              "value": "walkfront"
            }
          ],
          "store_result": "test_animation"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation",
          "store_result": "cleanup_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ]
        },
        {
          "step_type": "function",
          "function_name": "assign_animation_with_script_and_sound",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            },
            {
              "value_type": "variable",
              "variable_name": "test_script"
            },
            {
              "value_type": "string",
              "value": "walkleft"
            },
            {
              "value_type": "bool",
              "value": true
            }
          ]
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "equal",
            "value1": {
              "value_type": "string",
              "value": "walkleft"
            },
            "value2": {
              "value_type": "function",
              "function_name": "animation_name",
              "args": [
                {
                  "value_type": "variable",
                  "variable_name": "test_animation"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "assign_animation_index_with_script",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "kermit"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ],
          "store_result": "test_script"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "function",
          "function_name": "create_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_script"
            },
            {
              "value_type": "string",
              "value": "moonwalkback"
            }
          ],
          "store_result": "test_animation"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation",
          "store_result": "cleanup_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ]
        },
        {
          "step_type": "function",
          "function_name": "assign_animation_index_with_script",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            },
            {
              "value_type": "variable",
              "variable_name": "test_script"
            },
            {
              "value_type": "int",
              "value": 0
            }
          ]
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "equal",
            "value1": {
              "value_type": "string",
              "value": "walkfront"
            },
            "value2": {
              "value_type": "function",
              "function_name": "animation_name",
              "args": [
                {
                  "value_type": "variable",
                  "variable_name": "test_animation"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "assign_animation_index_with_script_and_sound",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "kermit"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ],
          "store_result": "test_script"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "function",
          "function_name": "create_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_script"
            },
            {
              "value_type": "string",
              "value": "moonwalkback"
            }
          ],
          "store_result": "test_animation"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation",
          "store_result": "cleanup_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ]
        },
        {
          "step_type": "function",
          "function_name": "assign_animation_index_with_script_and_sound",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            },
            {
              "value_type": "variable",
              "variable_name": "test_script"
            },
            {
              "value_type": "int",
              "value": 0
            },
            {
              "value_type": "bool",
              "value": true
            }
          ]
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "equal",
            "value1": {
              "value_type": "string",
              "value": "walkfront"
            },
            "value2": {
              "value_type": "function",
              "function_name": "animation_name",
              "args": [
                {
                  "value_type": "variable",
                  "variable_name": "test_animation"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "assign_animation_with_script_named",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "kermit"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ],
          "store_result": "test_script"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "function",
          "function_name": "create_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_script"
            },
            {
              "value_type": "string",
              "value": "moonwalkback"
            }
          ],
          "store_result": "test_animation"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation",
          "store_result": "cleanup_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ]
        },
        {
          "step_type": "function",
          "function_name": "assign_animation_with_script_named",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            },
            {
              "value_type": "string",
              "value": "kermit"
            },
            {
              "value_type": "string",
              "value": "walkfront"
            }
          ]
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "equal",
            "value1": {
              "value_type": "string",
              "value": "walkfront"
            },
            "value2": {
              "value_type": "function",
              "function_name": "animation_name",
              "args": [
                {
                  "value_type": "variable",
                  "variable_name": "test_animation"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "assign_animation_with_script_named_and_sound",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "kermit"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ],
          "store_result": "test_script"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "function",
          "function_name": "create_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_script"
            },
            {
              "value_type": "string",
              "value": "walkfront"
            }
          ],
          "store_result": "test_animation"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation",
          "store_result": "cleanup_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ]
        },
        {
          "step_type": "function",
          "function_name": "assign_animation_with_script_named_and_sound",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            },
            {
              "value_type": "string",
              "value": "kermit"
            },
            {
              "value_type": "string",
              "value": "walkfront"
            },
            {
              "value_type": "bool",
              "value": true
            }
          ]
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "equal",
            "value1": {
              "value_type": "string",
              "value": "walkfront"
            },
            "value2": {
              "value_type": "function",
              "function_name": "animation_name",
              "args": [
                {
                  "value_type": "variable",
                  "variable_name": "test_animation"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "assign_animation_index",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "kermit"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ],
          "store_result": "test_script"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "function",
          "function_name": "create_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_script"
            },
            {
              "value_type": "string",
              "value": "moonwalkback"
            }
          ],
          "store_result": "test_animation"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation",
          "store_result": "cleanup_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ]
        },
        {
          "step_type": "function",
          "function_name": "assign_animation_index",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            },
            {
              "value_type": "int",
              "value": 0
            }
          ]
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "equal",
            "value1": {
              "value_type": "int",
              "value": 0
            },
            "value2": {
              "value_type": "function",
              "function_name": "animation_current_cell",
              "args": [
                {
                  "value_type": "variable",
                  "variable_name": "test_animation"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "assign_animation_index_with_sound",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "kermit"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ],
          "store_result": "test_script"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "function",
          "function_name": "create_animation_with_sound",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_script"
            },
            {
              "value_type": "string",
              "value": "moonwalkback"
            },
            {
              "value_type": "bool",
              "value": false
            }
          ],
          "store_result": "test_animation"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation",
          "store_result": "cleanup_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ]
        },
        {
          "step_type": "function",
          "function_name": "assign_animation_index_with_sound",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            },
            {
              "value_type": "int",
              "value": 0
            },
            {
              "value_type": "bool",
              "value": true
            }
          ]
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "true",
            "value1": {
              "value_type": "function",
              "function_name": "animation_entered_frame",
              "args": [
                {
                  "value_type": "variable",
                  "variable_name": "test_animation"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "assign_animation",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "kermit"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ],
          "store_result": "test_script"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "function",
          "function_name": "create_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_script"
            },
            {
              "value_type": "string",
              "value": "moonwalkback"
            }
          ],
          "store_result": "test_animation"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation",
          "store_result": "cleanup_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ]
        },
        {
          "step_type": "function",
          "function_name": "assign_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            },
            {
              "value_type": "string",
              "value": "walkfront"
            }
          ]
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "equal",
            "value1": {
              "value_type": "string",
              "value": "walkfront"
            },
            "value2": {
              "value_type": "function",
              "function_name": "animation_name",
              "args": [
                {
                  "value_type": "variable",
                  "variable_name": "test_animation"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "assign_animation_with_sound",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "kermit"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ],
          "store_result": "test_script"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "function",
          "function_name": "create_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_script"
            },
            {
              "value_type": "string",
              "value": "moonwalkback"
            }
          ],
          "store_result": "test_animation"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation",
          "store_result": "cleanup_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ]
        },
        {
          "step_type": "function",
          "function_name": "assign_animation_with_sound",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            },
            {
              "value_type": "string",
              "value": "walkfront"
            },
            {
              "value_type": "bool",
              "value": true
            }
          ]
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "equal",
            "value1": {
              "value_type": "string",
              "value": "walkfront"
            },
            "value2": {
              "value_type": "function",
              "function_name": "animation_name",
              "args": [
                {
                  "value_type": "variable",
                  "variable_name": "test_animation"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "create_animation_from_index_with_sound",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "kermit"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ],
          "store_result": "test_script"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "function",
          "function_name": "create_animation_from_index_with_sound",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_script"
            },
            {
              "value_type": "int",
              "value": 0
            },
            {
              "value_type": "bool",
              "value": true
            }
          ],
          "store_result": "test_animation"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation",
          "store_result": "cleanup_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ]
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "not_null",
            "value1": {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          }
        },
        {
          "step_type": "function",
          "function_name": "animation_name",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ],
          "store_result": "anim_name"
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "equal",
            "value1": {
              "value_type": "string",
              "value": "walkfront"
            },
            "value2": {
              "value_type": "variable",
              "variable_name": "anim_name"
            }
          }
        }
      ]
    },
    {
      "name": "create_animation",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "kermit"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ],
          "store_result": "test_script"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "function",
          "function_name": "create_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_script"
            },
            {
              "value_type": "string",
              "value": "moonwalkback"
            }
          ],
          "store_result": "test_animation"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation",
          "store_result": "cleanup_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ]
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "not_null",
            "value1": {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          }
        },
        {
          "step_type": "function",
          "function_name": "animation_name",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ],
          "store_result": "anim_name"
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "equal",
            "value1": {
              "value_type": "string",
              "value": "moonwalkback"
            },
            "value2": {
              "value_type": "variable",
              "variable_name": "anim_name"
            }
          }
        }
      ]
    },
    {
      "name": "create_animation_with_sound",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "kermit"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ],
          "store_result": "test_script"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "function",
          "function_name": "create_animation_with_sound",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_script"
            },
            {
              "value_type": "string",
              "value": "moonwalkback"
            },
            {
              "value_type": "bool",
              "value": true
            }
          ],
          "store_result": "test_animation"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation",
          "store_result": "cleanup_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ]
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "not_null",
            "value1": {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          }
        },
        {
          "step_type": "function",
          "function_name": "animation_name",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ],
          "store_result": "anim_name"
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "equal",
            "value1": {
              "value_type": "string",
              "value": "moonwalkback"
            },
            "value2": {
              "value_type": "variable",
              "variable_name": "anim_name"
            }
          }
        }
      ]
    },
    {
      "name": "create_animation_from_script_named",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "kermit"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ]
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "function",
          "function_name": "create_animation_from_script_named",
          "args": [
            {
              "value_type": "string",
              "value": "kermit"
            },
            {
              "value_type": "string",
              "value": "moonwalkback"
            }
          ],
          "store_result": "test_animation"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation",
          "store_result": "cleanup_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ]
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "not_null",
            "value1": {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          }
        },
        {
          "step_type": "function",
          "function_name": "animation_name",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ],
          "store_result": "anim_name"
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "equal",
            "value1": {
              "value_type": "string",
              "value": "moonwalkback"
            },
            "value2": {
              "value_type": "variable",
              "variable_name": "anim_name"
            }
          }
        }
      ]
    },
    {
      "name": "create_animation_from_script_named_with_sound",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "test_script"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ]
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "function",
          "function_name": "create_animation_from_script_named_with_sound",
          "args": [
            {
              "value_type": "string",
              "value": "test_script"
            },
            {
              "value_type": "string",
              "value": "moonwalkback"
            },
            {
              "value_type": "bool",
              "value": true
            }
          ],
          "store_result": "test_animation"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation",
          "store_result": "cleanup_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ]
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "not_null",
            "value1": {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          }
        },
        {
          "step_type": "function",
          "function_name": "animation_name",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ],
          "store_result": "anim_name"
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "equal",
            "value1": {
              "value_type": "string",
              "value": "moonwalkback"
            },
            "value2": {
              "value_type": "variable",
              "variable_name": "anim_name"
            }
          }
        }
      ]
    },
    {
      "name": "free_all_animation_scripts",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "free_all_kermit1"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ]
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "free_all_kermit2"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ]
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "true",
            "value1": {
              "value_type": "function",
              "function_name": "has_animation_script",
              "args": [
                {
                  "value_type": "string",
                  "value": "free_all_kermit1"
                }
              ]
            }
          }
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "true",
            "value1": {
              "value_type": "function",
              "function_name": "has_animation_script",
              "args": [
                {
                  "value_type": "string",
                  "value": "free_all_kermit2"
                }
              ]
            }
          }
        },
        {
          "step_type": "function",
          "function_name": "free_all_animation_scripts",
          "args": []
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "false",
            "value1": {
              "value_type": "function",
              "function_name": "has_animation_script",
              "args": [
                {
                  "value_type": "string",
                  "value": "free_all_kermit1"
                }
              ]
            }
          }
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "false",
            "value1": {
              "value_type": "function",
              "function_name": "has_animation_script",
              "args": [
                {
                  "value_type": "string",
                  "value": "free_all_kermit2"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "free_animation",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "kermit"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ],
          "store_result": "test_script"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "function",
          "function_name": "create_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_script"
            },
            {
              "value_type": "string",
              "value": "moonwalkback"
            }
          ],
          "store_result": "test_animation"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation",
          "store_result": "cleanup_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ]
        },
        {
          "step_type": "function",
          "function_name": "free_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ]
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "equal",
            "value1": {
              "value_type": "string",
              "value": ""
            },
            "value2": {
              "value_type": "function",
              "function_name": "animation_name",
              "args": [
                {
                  "value_type": "variable",
                  "variable_name": "test_animation"
                }
              ]
            }
          }
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "true",
            "value1": {
              "value_type": "function",
              "function_name": "animation_ended",
              "args": [
                {
                  "value_type": "variable",
                  "variable_name": "test_animation"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "free_animation_script",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "kermit"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ],
          "store_result": "test_script"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "not_null",
            "value1": {
              "value_type": "variable",
              "variable_name": "test_script"
            }
          }
        },
        {
          "step_type": "function",
          "function_name": "free_animation_script",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_script"
            }
          ]
        },
        {
          "step_type": "function",
          "function_name": "has_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "has_kermit"
            }
          ],
          "store_result": "script_exists"
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "false",
            "value1": {
              "value_type": "variable",
              "variable_name": "script_exists"
            }
          }
        }
      ]
    },
    {
      "name": "free_animation_script_with_name",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "free_kermit"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ]
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "true",
            "value1": {
              "value_type": "function",
              "function_name": "has_animation_script",
              "args": [
                {
                  "value_type": "string",
                  "value": "free_kermit"
                }
              ]
            }
          }
        },
        {
          "step_type": "function",
          "function_name": "free_animation_script_with_name",
          "args": [
            {
              "value_type": "string",
              "value": "free_kermit"
            }
          ]
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "false",
            "value1": {
              "value_type": "function",
              "function_name": "has_animation_script",
              "args": [
                {
                  "value_type": "string",
                  "value": "free_kermit"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "has_animation_named",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "kermit"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ],
          "store_result": "test_script"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "function",
          "function_name": "has_animation_named",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_script"
            },
            {
              "value_type": "string",
              "value": "walkfront"
            }
          ],
          "store_result": "has_walkfront"
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "true",
            "value1": {
              "value_type": "variable",
              "variable_name": "has_walkfront"
            }
          }
        },
        {
          "step_type": "function",
          "function_name": "has_animation_named",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_script"
            },
            {
              "value_type": "string",
              "value": "NonExistentAnimation"
            }
          ],
          "store_result": "has_nonexistent"
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "false",
            "value1": {
              "value_type": "variable",
              "variable_name": "has_nonexistent"
            }
          }
        }
      ]
    },
    {
      "name": "has_animation_script",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "has_kermit"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ],
          "store_result": "test_script"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "true",
            "value1": {
              "value_type": "function",
              "function_name": "has_animation_script",
              "args": [
                {
                  "value_type": "string",
                  "value": "has_kermit"
                }
              ]
            }
          }
        },
        {
          "step_type": "function",
          "function_name": "free_animation_script",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_script"
            }
          ]
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "false",
            "value1": {
              "value_type": "function",
              "function_name": "has_animation_script",
              "args": [
                {
                  "value_type": "string",
                  "value": "has_kermit"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "load_animation_script",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "test_animation_name"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ],
          "store_result": "test_script"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "not_null",
            "value1": {
              "value_type": "variable",
              "variable_name": "test_script"
            }
          }
        },
        {
          "step_type": "function",
          "function_name": "animation_script_name",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_script"
            }
          ],
          "store_result": "script_name"
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "equal",
            "value1": {
              "value_type": "string",
              "value": "test_animation_name"
            },
            "value2": {
              "value_type": "variable",
              "variable_name": "script_name"
            }
          }
        },
        {
          "step_type": "function",
          "function_name": "free_animation_script",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_script"
            }
          ]
        },
        {
          "step_type": "function",
          "function_name": "has_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "test_animation_name"
            }
          ],
          "store_result": "script_exists"
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "false",
            "value1": {
              "value_type": "variable",
              "variable_name": "script_exists"
            }
          }
        }
      ]
    },
    {
      "name": "restart_animation",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "kermit"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ],
          "store_result": "test_script"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "function",
          "function_name": "create_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_script"
            },
            {
              "value_type": "string",
              "value": "moonwalkback"
            }
          ],
          "store_result": "test_animation"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation",
          "store_result": "cleanup_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ]
        },
        {
          "step_type": "loop",
          "iterations": 50,
          "loop_steps": [
            {
              "step_type": "function",
              "function_name": "update_animation_percent",
              "args": [
                {
                  "value_type": "variable",
                  "variable_name": "test_animation"
                },
                {
                  "value_type": "float",
                  "value": 100.0
                }
              ]
            }
          ]
        },
        {
          "step_type": "function",
          "function_name": "animation_ended",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ],
          "store_result": "anim_ended"
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "true",
            "value1": {
              "value_type": "variable",
              "variable_name": "anim_ended"
            }
          }
        },
        {
          "step_type": "function",
          "function_name": "restart_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ]
        },
        {
          "step_type": "function",
          "function_name": "animation_ended",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ],
          "store_result": "anim_ended_after_restart"
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "false",
            "value1": {
              "value_type": "variable",
              "variable_name": "anim_ended_after_restart"
            }
          }
        }
      ]
    },
    {
      "name": "restart_animation_with_sound",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "kermit"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ],
          "store_result": "test_script"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "function",
          "function_name": "create_animation_with_sound",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_script"
            },
            {
              "value_type": "string",
              "value": "moonwalkback"
            },
            {
              "value_type": "bool",
              "value": true
            }
          ],
          "store_result": "test_animation"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation",
          "store_result": "cleanup_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ]
        },
        {
          "step_type": "function",
          "function_name": "update_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ]
        },
        {
          "step_type": "function",
          "function_name": "restart_animation_with_sound",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            },
            {
              "value_type": "bool",
              "value": true
            }
          ]
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "equal",
            "value1": {
              "value_type": "int",
              "value": 3
            },
            "value2": {
              "value_type": "function",
              "function_name": "animation_current_cell",
              "args": [
                {
                  "value_type": "variable",
                  "variable_name": "test_animation"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "update_animation_percent_with_sound",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "kermit"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ],
          "store_result": "test_script"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "function",
          "function_name": "create_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_script"
            },
            {
              "value_type": "string",
              "value": "moonwalkback"
            }
          ],
          "store_result": "test_animation"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation",
          "store_result": "cleanup_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ]
        },
        {
          "step_type": "function",
          "function_name": "update_animation_percent_with_sound",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            },
            {
              "value_type": "float",
              "value": 0.5
            },
            {
              "value_type": "bool",
              "value": true
            }
          ]
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "greater_than",
            "value1": {
              "value_type": "function",
              "function_name": "animation_frame_time",
              "args": [
                {
                  "value_type": "variable",
                  "variable_name": "test_animation"
                }
              ]
            },
            "value2": {
              "value_type": "float",
              "value": 0.0
            }
          }
        }
      ]
    },
    {
      "name": "update_animation",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "kermit"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ],
          "store_result": "test_script"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "function",
          "function_name": "create_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_script"
            },
            {
              "value_type": "string",
              "value": "moonwalkback"
            }
          ],
          "store_result": "test_animation"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation",
          "store_result": "cleanup_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ]
        },
        {
          "step_type": "function",
          "function_name": "update_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ]
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "not_equal",
            "value1": {
              "value_type": "int",
              "value": 0
            },
            "value2": {
              "value_type": "function",
              "function_name": "animation_current_cell",
              "args": [
                {
                  "value_type": "variable",
                  "variable_name": "test_animation"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "update_animation_percent",
      "steps": [
        {
          "step_type": "function",
          "function_name": "load_animation_script",
          "args": [
            {
              "value_type": "string",
              "value": "kermit"
            },
            {
              "value_type": "string",
              "value": "kermit.txt"
            }
          ],
          "store_result": "test_script"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation_script",
          "store_result": "cleanup_animation_script"
        },
        {
          "step_type": "function",
          "function_name": "create_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_script"
            },
            {
              "value_type": "string",
              "value": "walkfront"
            }
          ],
          "store_result": "test_animation"
        },
        {
          "step_type": "cleanup",
          "cleanup_type": "animation",
          "store_result": "cleanup_animation",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            }
          ]
        },
        {
          "step_type": "function",
          "function_name": "update_animation_percent",
          "args": [
            {
              "value_type": "variable",
              "variable_name": "test_animation"
            },
            {
              "value_type": "float",
              "value": 0.5
            }
          ]
        },
        {
          "step_type": "assertion",
          "compare": {
            "compare_type": "greater_than",
            "value1": {
              "value_type": "function",
              "function_name": "animation_frame_time",
              "args": [
                {
                  "value_type": "variable",
                  "variable_name": "test_animation"
                }
              ]
            },
            "value2": {
              "value_type": "float",
              "value": 0.0
            }
          }
        }
      ]
    }
  ]
}
